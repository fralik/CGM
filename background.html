<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
    <head>
        <script type="text/javascript" src="js/common.js"></script>
        <script type="text/javascript">
            function onRequest(request, sender, sendResponse) {
                if (sender.tab) {
                    console.error('Got message from a content script: ' + sender.tab.url);
                }
                
                if (request.action == "getLayout") {
                    //console.error('cgm, background, must send layout to injected');
                    chrome.pageAction.show(sender.tab.id);
                    
                    var o = cgm.common.loadLayout(sender.tab.url);
                    sendResponse(o);
                } else if (request.action == "show_popup_icon") {
                    chrome.pageAction.show(sender.tab.id);
                    //console.error('cgm, background, reply for show_popup_icon');
                    sendResponse({});
                } else if (request.action == "sendPorts") {
                    //console.error('cgm, background, reply for sendPorts');
                    sendResponse({});
                } else {
                    //console.error('sending back empty response');
                    sendResponse({});
                }
            }
            
            chrome.extension.onRequest.addListener(onRequest);
        </script>
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-26179092-1']);
            _gaq.push(['_trackPageview']);

            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </head>
</html>